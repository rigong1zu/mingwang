import{c as G,G as W,r as c,j as e,P as F,n as I,B as u,a as z,C as H,u as w,J,K as X,O as B,Q,R as U,d as K,b as $,T as Y,s as Z,f as y,U as ee,V as ae,W as se,X as te,Y as S,M as re,Z as ne,L as le,e as oe,w as ie,g as ce,t as de}from"./index.b12a37b1.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=G("Files",[["path",{d:"M15.5 2H8.6c-.4 0-.8.2-1.1.5-.3.3-.5.7-.5 1.1v12.8c0 .4.2.8.5 1.1.3.3.7.5 1.1.5h9.8c.4 0 .8-.2 1.1-.5.3-.3.5-.7.5-1.1V6.5L15.5 2z",key:"cennsq"}],["path",{d:"M3 7.6v12.8c0 .4.2.8.5 1.1.3.3.7.5 1.1.5h9.8",key:"ms809a"}],["path",{d:"M15 2v5h5",key:"qq6kwv"}]]);var j="Progress",N=100,[me,Pe]=W(j),[pe,xe]=me(j),L=c.forwardRef((a,s)=>{const{__scopeProgress:o,value:t=null,max:r,getValueLabel:m=he,...p}=a;(r||r===0)&&!M(r)&&console.error(fe(`${r}`,"Progress"));const n=M(r)?r:N;t!==null&&!E(t,n)&&console.error(ge(`${t}`,"Progress"));const i=E(t,n)?t:null,x=f(i)?m(i,n):void 0;return e.jsx(pe,{scope:o,value:i,max:n,children:e.jsx(F.div,{"aria-valuemax":n,"aria-valuemin":0,"aria-valuenow":f(i)?i:void 0,"aria-valuetext":x,role:"progressbar","data-state":V(i,n),"data-value":i??void 0,"data-max":n,...p,ref:s})})});L.displayName=j;var T="ProgressIndicator",R=c.forwardRef((a,s)=>{const{__scopeProgress:o,...t}=a,r=xe(T,o);return e.jsx(F.div,{"data-state":V(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...t,ref:s})});R.displayName=T;function he(a,s){return`${Math.round(a/s*100)}%`}function V(a,s){return a==null?"indeterminate":a===s?"complete":"loading"}function f(a){return typeof a=="number"}function M(a){return f(a)&&!isNaN(a)&&a>0}function E(a,s){return f(a)&&!isNaN(a)&&a<=s&&a>=0}function fe(a,s){return`Invalid prop \`max\` of value \`${a}\` supplied to \`${s}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${N}\`.`}function ge(a,s){return`Invalid prop \`value\` of value \`${a}\` supplied to \`${s}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${N} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var q=L,ve=R;const A=c.forwardRef(({className:a,value:s,...o},t)=>e.jsx(q,{ref:t,className:I("relative h-4 w-full overflow-hidden rounded-full bg-muted",a),...o,children:e.jsx(ve,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));A.displayName=q.displayName;function we({current:a,total:s,quota:o}){const{t}=w();return e.jsxs("div",{className:"article-progress w-full mb-4",children:[e.jsx("p",{className:"select-none mt-4 mb-2.5 flex flex-row items-center content-center w-full justify-center text-center",children:s!==0&&a===s?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-5 w-5 mr-2 inline-block animate-out shrink-0"}),t("article.generate-success")]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-5 w-5 mr-2 inline-block animate-spin shrink-0"}),t("article.progress-title",{current:a,total:s})]})}),e.jsx(A,{value:100*a/s}),e.jsxs("div",{className:"article-quota flex flex-row mt-4 border border-input rounded-md py-1 px-3 select-none w-max items-center mx-auto",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),e.jsx("p",{children:o.toFixed(2)})]})]})}function je(){const{t:a}=w(),s=U(),{toast:o}=K(),t=$(Y),r=$(Z),[m,p]=c.useState(""),[n,i]=c.useState(""),[x,g]=c.useState(!1),[_,b]=c.useState({current:0,total:0}),[P,C]=c.useState(0),[v,k]=c.useState("");function O(){p(""),i(""),k(""),g(!1),C(0),b({current:0,total:0})}function D(){g(!0);const l=new WebSocket(`${ie}/article/create`);l.onopen=()=>{l.send(JSON.stringify({token:ce(de),web:t,title:n,prompt:m,model:r}))},l.onmessage=h=>{const d=JSON.parse(h.data);d.data&&d.data.quota&&C(P+d.data.quota),d.hash?(o({title:a("article.generate-success"),description:a("article.generate-success-prompt")}),k(d.hash)):b(d.data)},l.onerror=h=>{console.debug(`[article] error during generation: ${h}`),o({title:a("article.generate-failed"),description:`${a("article.generate-failed-prompt")} (${h.toString()})`}),g(!1),l.close()}}return x?e.jsxs(e.Fragment,{children:[e.jsx(we,{..._,quota:P}),v&&e.jsxs("div",{className:"article-action flex flex-row items-center my-4 gap-4",children:[e.jsxs(u,{variant:"outline",className:"w-full whitespace-nowrap",onClick:()=>{location.href=`${y}/article/download/zip?hash=${v}`},children:[" ",a("article.download-format",{name:"zip"})," "]}),e.jsxs(u,{variant:"outline",className:"w-full whitespace-nowrap",onClick:()=>{location.href=`${y}/article/download/tar?hash=${v}`},children:[" ",a("article.download-format",{name:"tar"})," "]})]}),e.jsx(u,{variant:"default",className:"mt-5 w-full mx-auto",onClick:O,children:a("close")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row items-center mx-auto",children:[e.jsx(ee,{"aria-label":a("chat.web-aria"),defaultPressed:!1,onPressedChange:l=>s(ae(l)),variant:"outline",children:e.jsx(se,{className:I("h-4 w-4 web",t&&"enable")})}),e.jsx(te,{className:"ml-2.5 whitespace-nowrap",children:a("article.web-checkbox")})]}),e.jsx(S,{placeholder:a("article.prompt-placeholder"),rows:3,value:m,onChange:l=>p(l.target.value)}),e.jsx(S,{placeholder:a("article.input-placeholder"),rows:8,value:n,onChange:l=>i(l.target.value)}),e.jsx(re,{side:"bottom"}),e.jsx(u,{variant:"default",className:"mt-5 w-full mx-auto",onClick:D,disabled:x||!n,children:a("article.generate")})]})}function Ne(){const{t:a}=w();return e.jsxs(J,{className:"article-wrapper",children:[e.jsx(X,{className:"py-4",children:e.jsxs(B,{className:"article-title",children:[e.jsx(ue,{className:"h-5 w-5 mr-2"}),a("article.title")]})}),e.jsx(Q,{className:"article-content",children:e.jsx(je,{})})]})}function Ce(){return e.jsx("div",{className:"article-page",children:e.jsxs("div",{className:"article-container",children:[e.jsx(u,{className:"action",variant:"ghost",size:"icon",onClick:()=>z.navigate("/"),children:e.jsx(H,{className:"h-5 w-5 back"})}),e.jsx(Ne,{})]})})}export{Ce as default};
